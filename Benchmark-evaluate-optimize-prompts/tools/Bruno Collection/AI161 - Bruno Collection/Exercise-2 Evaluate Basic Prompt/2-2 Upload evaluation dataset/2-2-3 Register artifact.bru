meta {
  name: 2-2-3 Register artifact
  type: http
  seq: 3
}

post {
  url: {{AI_API_URL}}/v2/lm/artifacts
  body: json
  auth: bearer
}

params:query {
  ~executionScheduleId: 
}

headers {
  AI-Resource-Group: default
}

auth:bearer {
  token: {{TOKEN}}
}

body:json {
  {
    "name": "genai-eval-simplified-test-data",
    "kind": "other",
    "url": "ai://default/{{groupID}}/",
    "description": "Artifact for evaluation flow",
    "scenarioId": "genai-evaluations"
  }
}

script:post-response {
  let data = res.getBody();
  if (data.id) {
    let artifactID = data.id;
    // https://docs.usebruno.com/testing/script/javascript-reference#setenvvar
    bru.setEnvVar("evalArtifactID", artifactID);
    console.info("Set evalArtifactID to:", artifactID);
  }
}
